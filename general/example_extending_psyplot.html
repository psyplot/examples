<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Extending psyplot &mdash; psyplot-examples version 2beaea1</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Applying your own post processing" href="example_post.html" />
    <link rel="prev" title="General Examples" href="README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> psyplot-examples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../regression-analysis/example_densityreg.html">Plot a fit over a density plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regression-analysis/example_basic_fit.html">Creating and accessing a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/example_ugrid.html">Visualizing unstructured data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/example_mapplotters.html">Basic data visualization on a map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/example_circumpolar.html">Visualizing circumpolar data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple/example_violin.html">Violin plot demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple/example_vector.html">Vector plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple/example_plot2d.html">2D plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple/example_line.html">Line plot demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simple/example_bar.html">Bar plot demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_sharing.html">Sharing formatoptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_post.html">Applying your own post processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_post.html#Saving-and-loading">Saving and loading</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Extending psyplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#1.-The-standard-matplotlib-approach">1. The standard matplotlib approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.1-Advantages:">1.1 Advantages:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.2-Disadvantages">1.2 Disadvantages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.2.1.-It-does-not-benefit-from-the-interactive-psyplot-framework">1.2.1. It does not benefit from the interactive psyplot framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1.2.2.-It-results-in-copy-pasting">1.2.2. It results in copy-pasting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#2.-The-post-formatoption">2. The <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#2.1-Advantages">2.1 Advantages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2-Disadvantages">2.2 Disadvantages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#3.-The-formatoption-approach">3. The formatoption approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#3.1-Advantages">3.1 Advantages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.2-Disadvantages">3.2 Disadvantages</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">psyplot-examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Extending psyplot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/general/example_extending_psyplot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
  This page was generated from
  <a class="reference external" href="https://github.com/psyplot/examples/blob/2beaea1/general/example_extending_psyplot.ipynb">general/example_extending_psyplot.ipynb</a>.
  <br>
  Interactive online version:
  <span style="white-space: nowrap;"><a href="https://mybinder.org/v2/gh/psyplot/examples/2beaea1?filepath=general/example_extending_psyplot.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge_logo.svg" style="vertical-align:text-bottom"></a>.</span>
  <script>
    if (document.location.host) {
      $(document.currentScript).replaceWith(
        '<a class="reference external" ' +
        'href="https://nbviewer.jupyter.org/url' +
        (window.location.protocol == 'https:' ? 's/' : '/') +
        window.location.host +
        window.location.pathname.slice(0, -4) +
        'ipynb">View in <em>nbviewer</em></a>.'
      );
    }
  </script>
</div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example requires the <a class="reference download internal" download="" href="../_downloads/7f633640bea5413a226f61fc95701c45/demo.nc"><code class="xref download docutils literal notranslate"><span class="pre">demo.nc</span></code></a> file.</p>
</div>
<section id="Extending-psyplot">
<h1>Extending psyplot<a class="headerlink" href="#Extending-psyplot" title="Permalink to this headline"></a></h1>
<p>This notebook demonstrates how psyplot can be extended with your own plotting scripts.</p>
<p>There are three ways that we demonstrate:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="#1.-The-standard-matplotlib-approach">the standard matplotlib approach</a></p></li>
<li><p><a class="reference external" href="#2.-The-post-formatoption">the post formatoption approach</a></p></li>
<li><p><a class="reference external" href="#3.-The-formatoption-approach">the formatoption approach</a></p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">psyplot.project</span> <span class="k">as</span> <span class="nn">psy</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">psy</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;plotter.maps.xgrid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">psy</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;plotter.maps.ygrid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">psy</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;plotter.plot2d.cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;viridis&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:matplotlib.font_manager:generated new fontManager
</pre></div></div>
</div>
<p>We will demonstrate the different strategies with the functionality to add country boarders to the plot via cartopy. In a standard setting, this can be achieved pretty easily via <code class="docutils literal notranslate"><span class="pre">ax.add_feature(cf.BORDERS)</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">81</span><span class="p">])</span>  <span class="c1"># focus on Europe</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;cartopy.mpl.feature_artist.FeatureArtist at 0x7f7d17f46910&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_0_boundary_lines_land.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_3_2.png" src="../_images/general_example_extending_psyplot_3_2.png" />
</div>
</div>
<p>Our standard setting for psyplot would be something like</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
psyplot.project.Project([    arr0: 2-dim DataArray of t2m, with (lat, lon)=(96, 192), lev=100000.0, time=1979-01-31T18:00:00])
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_5_2.png" src="../_images/general_example_extending_psyplot_5_2.png" />
</div>
</div>
<section id="1.-The-standard-matplotlib-approach">
<h2>1. The standard matplotlib approach<a class="headerlink" href="#1.-The-standard-matplotlib-approach" title="Permalink to this headline"></a></h2>
<p>This the straight-forward approach that uses the fact that you can always access the matplotlib axes and run your own scripts. So we just combine the two steps from above:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">plotters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;cartopy.mpl.feature_artist.FeatureArtist at 0x7f7d0f5f9a60&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_7_2.png" src="../_images/general_example_extending_psyplot_7_2.png" />
</div>
</div>
<section id="1.1-Advantages:">
<h3>1.1 Advantages:<a class="headerlink" href="#1.1-Advantages:" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>straight-forward matplotlib</p></li>
<li><p>You do not have to interact with the psyplot framework at all</p></li>
</ul>
</section>
<section id="1.2-Disadvantages">
<h3>1.2 Disadvantages<a class="headerlink" href="#1.2-Disadvantages" title="Permalink to this headline"></a></h3>
<section id="1.2.1.-It-does-not-benefit-from-the-interactive-psyplot-framework">
<h4>1.2.1. It does not benefit from the interactive psyplot framework<a class="headerlink" href="#1.2.1.-It-does-not-benefit-from-the-interactive-psyplot-framework" title="Permalink to this headline"></a></h4>
<p>If you change your projection for instance, psyplot has to redraw the plot. See the following example where we change the projection of the basemap <strong>after</strong> the borders have been drawn.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">plotters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;moll&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_10_0.png" src="../_images/general_example_extending_psyplot_10_0.png" />
</div>
</div>
<p>Within the psyplot framework, we can encode when a feature in the plot needs to be drawn again. Changing the projection is a very expensive procedure. We first need to clear the axes and then regenerate the plot from scratch. As psyplot does not know anything about your <em>borders</em>, you have to rerun your script here.</p>
</section>
<section id="1.2.2.-It-results-in-copy-pasting">
<h4>1.2.2. It results in copy-pasting<a class="headerlink" href="#1.2.2.-It-results-in-copy-pasting" title="Permalink to this headline"></a></h4>
<p>Adding country borders is a pretty simple task. But imagine you have a more challenging task for the visualization and you want to use this in many different scripts or even interactively via IPython. Then you need to copy-paste your code from one script to the other and this is not DRY (don’t repeat yourself) at all.</p>
</section>
</section>
</section>
<section id="2.-The-post-formatoption">
<h2>2. The <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption<a class="headerlink" href="#2.-The-post-formatoption" title="Permalink to this headline"></a></h2>
<p>Another way that would be more psyplot-like is to use the <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption. You can find more about this <a class="reference external" href="https://psyplot.github.io/examples/general/example_post.html">here</a>.</p>
<p>You have two formatoptions for every plotter:</p>
<ol class="arabic simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption takes a script that is executed with the <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption itself as <code class="docutils literal notranslate"><span class="pre">self</span></code> (i.e. you can access the matplotlib axes via <code class="docutils literal notranslate"><span class="pre">self.ax</span></code> in your script</p></li>
<li><p>You can specify when your script is executed via the <code class="docutils literal notranslate"><span class="pre">post_timing</span></code> formatoption.</p></li>
</ol>
<p>The plot above would be generated via</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span>
    <span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s2">&quot;import cartopy.feature as cf; self.ax.add_feature(cf.BORDERS, color=&#39;red&#39;)&quot;</span><span class="p">,</span>
    <span class="n">post_timing</span><span class="o">=</span><span class="s2">&quot;replot&quot;</span><span class="p">,</span>
    <span class="n">enable_post</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_14_1.png" src="../_images/general_example_extending_psyplot_14_1.png" />
</div>
</div>
<section id="2.1-Advantages">
<h3>2.1 Advantages<a class="headerlink" href="#2.1-Advantages" title="Permalink to this headline"></a></h3>
<p>This way, you can use your standard matplotlib script (<code class="docutils literal notranslate"><span class="pre">self.ax.add_feature(cf.BORDERS)</span></code>) and still benefit from the interactivity via the <code class="docutils literal notranslate"><span class="pre">post_timing</span></code> formatoption.</p>
<p>Changing the projection, for instance, now also redraws the country borders</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span>
    <span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s2">&quot;import cartopy.feature as cf; self.ax.add_feature(cf.BORDERS, color=&#39;red&#39;)&quot;</span><span class="p">,</span>
    <span class="n">post_timing</span><span class="o">=</span><span class="s2">&quot;replot&quot;</span><span class="p">,</span>
    <span class="n">enable_post</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;moll&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_16_1.png" src="../_images/general_example_extending_psyplot_16_1.png" />
</div>
</div>
</section>
<section id="2.2-Disadvantages">
<h3>2.2 Disadvantages<a class="headerlink" href="#2.2-Disadvantages" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>It’s not very pythonic. The <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption takes python code and executes it via the built-in <code class="docutils literal notranslate"><span class="pre">exec</span></code> function. Using <code class="docutils literal notranslate"><span class="pre">exec</span></code> is always a security issue. This is why you have to explicitly allow the <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption with the <code class="docutils literal notranslate"><span class="pre">enable_post</span></code> argument in the call above.</p></li>
<li><p>You have to add your python code as string so you do not benefit from a lot of editor features, such as auto-completion, etc.</p></li>
<li><p>It’s hard to change the style of the borders as you have to change the script that you pass to the <code class="docutils literal notranslate"><span class="pre">post</span></code> formatoption</p></li>
</ol>
</section>
</section>
<section id="3.-The-formatoption-approach">
<h2>3. The formatoption approach<a class="headerlink" href="#3.-The-formatoption-approach" title="Permalink to this headline"></a></h2>
<p>The last approach here is the preferred method when you work with the psyplot framework. We generate our own formatoption and add it to the plotter. With this, we can make most out of the flexible and interactive framework, and we can easily reuse it across different scripts.</p>
<p>Formatoptions are just subclasses of the <code class="docutils literal notranslate"><span class="pre">psyplot.plotter.Formatoption</span></code>. We used a formatoption already with the <code class="docutils literal notranslate"><span class="pre">post</span></code> approach from above (the <code class="docutils literal notranslate"><span class="pre">self</span></code> is a formatoption). Our formatoption looks like:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">psyplot.plotter</span> <span class="kn">import</span> <span class="n">Formatoption</span>


<span class="k">class</span> <span class="nc">Borders</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw borders on a map&quot;&quot;&quot;</span>

    <span class="n">default</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">borders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;borders&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">borders</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">borders</span>
</pre></div>
</div>
</div>
<p>This formatoption defines three important attributes:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code>: The default value for the formatoption</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validate</span></code>: a validation method that validates and converts the value for the formatoption</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">update</span></code>: the method that adds (or removes) the borders</p></li>
</ol>
<p>Adding this formatoption to the <code class="docutils literal notranslate"><span class="pre">mapplot</span></code> plotmethod in psyplot is straight-forward. You just have to add it to the underlying plotter class that you can access via the <code class="docutils literal notranslate"><span class="pre">plotter_cls</span></code> attribute:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">borders</span> <span class="o">=</span> <span class="n">Borders</span><span class="p">(</span><span class="s2">&quot;borders&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now you can draw borders via the <code class="docutils literal notranslate"><span class="pre">borders</span></code> formatoption:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span> <span class="n">borders</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_23_1.png" src="../_images/general_example_extending_psyplot_23_1.png" />
</div>
</div>
<p>and you can remove them via <code class="docutils literal notranslate"><span class="pre">borders=False</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span> <span class="n">borders</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">borders</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_25_0.png" src="../_images/general_example_extending_psyplot_25_0.png" />
</div>
</div>
<p>and you can profit from the interactivity of psyplot and change difficult aspects, such as the projection</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapplot</span><span class="p">(</span><span class="s2">&quot;demo.nc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="n">map_extent</span><span class="o">=</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span> <span class="n">borders</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;moll&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/circleci/miniconda3/envs/docs/lib/python3.8/site-packages/cartopy/mpl/style.py:76: UserWarning: facecolor will have no effect as it has been defined as &#34;never&#34;.
  warnings.warn(&#39;facecolor will have no effect as it has been &#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/general_example_extending_psyplot_27_1.png" src="../_images/general_example_extending_psyplot_27_1.png" />
</div>
</div>
<section id="3.1-Advantages">
<h3>3.1 Advantages<a class="headerlink" href="#3.1-Advantages" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>Full compliance with the don’t repeat yourself principle</p></li>
<li><p>Uses the full flexibility of the psyplot framework</p></li>
<li><p>You can easily save the formatoption to a script and import it when you need it</p></li>
<li><p>You can create pull requests to psyplot and make your visualization methods available to others</p></li>
<li><p>You can enhance your formatoption. Here we only accept <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> as a value, but you could also easily make your formatoption accept a dictionary with color or linewidth to the formatoption, e.g.  <code class="docutils literal notranslate"><span class="pre">borders={&quot;color&quot;:</span> <span class="pre">&quot;red&quot;,</span> <span class="pre">&quot;linewidths&quot;:</span> <span class="pre">0.1})</span></code>.</p></li>
<li><p>If you make sure that your formatoption is always compatible with the latest version of matplotlib, cartopy, etc. you automatically make sure that all of your plotting scripts are still compatible.</p></li>
</ul>
</section>
<section id="3.2-Disadvantages">
<h3>3.2 Disadvantages<a class="headerlink" href="#3.2-Disadvantages" title="Permalink to this headline"></a></h3>
<p>You have to add a couple of lines of code.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="README.html" class="btn btn-neutral float-left" title="General Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example_post.html" class="btn btn-neutral float-right" title="Applying your own post processing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Philipp S. Sommer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>